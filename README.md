# Android Security Evolution
[![API](https://img.shields.io/badge/API-21%2B-brightgreen.svg)](https://android-arsenal.com/api?level=21)
[![last commit](https://img.shields.io/github/last-commit/balazsgerlei/AndroidSecurityEvolution?color=018786)](https://github.com/balazsgerlei/AndroidSecurityEvolution/commits/main)

Significant security enhancements of recent major Android versions, starting with _Android 5.0 Lollipop_ (API 21).

## Android 5.0 (API 21) - Lollipop

[Security Enhancements - Android 5](https://source.android.com/docs/security/enhancements#android-5)

* Starting August 2023, _Google Play Services_ updates will only be received from this Android version see [Google Play services discontinuing updates for KitKat (API levels 19 & 20) starting August 2023](https://android-developers.googleblog.com/2023/07/google-play-services-discontinuing-updates-for-kitkat.html)
* [Full Disk Encryption (FDE)](https://source.android.com/docs/security/features/encryption/full-disk) by default (manufacturers can still opt out), see [Encryption](https://source.android.com/docs/security/features/encryption) and [Security Enhancements in Android 5.0](https://source.android.com/docs/security/enhancements/enhancements50)
* [SELinux](https://source.android.com/docs/security/features/selinux) fully enforced, see [Security Enhancements in Android 5.0](https://source.android.com/docs/security/enhancements/enhancements50)
* `WebView` is a separate package, see [Security Enhancements in Android 5.0](https://source.android.com/docs/security/enhancements/enhancements50) and [The Updatable WebView on Android 5.0 Lollipop What Is It and Why Should You Care?](https://infinum.com/blog/the-updateable-webview-on-android-5-lollipop-what-is-it-and-why-should-you-care/)

## Android 6 (API 23) - Marshmallow

[Security Enhancements in Android 6](https://source.android.com/docs/security/enhancements#android-6)

* [Keystore](https://developer.android.com/reference/java/security/KeyStore) API significantly extended (symmetric cryptographic primitives, _AES_ and _HMAC_ support and access control system for hardware-backed keys) see [Hardware-backed Keystore](https://source.android.com/docs/security/features/keystore)
* [TEE](https://source.android.com/docs/security/features/trusty) is a requirement, see [Hardware-backed Keystore](https://source.android.com/docs/security/features/keystore) and [7.3.10. Fingerprint Sensor section of Android 6.0 Compatibility Definition](https://source.android.com/docs/compatibility/6.0/android-6.0-cdd#7_3_10_fingeprint)
* New API (`isInsideSecureHardware`) for checking whether a [KeyStore](https://developer.android.com/training/articles/keystore) key is stored in _secure hardware_ (e.g., [Trusted Execution Environment (TEE)](https://source.android.com/docs/security/features/trusty) or Secure Element (SE)), see [isInsideSecureHardware method of KeyInfo](https://developer.android.com/reference/android/security/keystore/KeyInfo#isInsideSecureHardware())
* Apps need to request permissions at runtime see [Runtime Permissions section of Android 6.0 Changes](https://developer.android.com/about/versions/marshmallow/android-6.0-changes#behavior-runtime-permissions) and [Request runtime permissions](https://developer.android.com/training/permissions/requesting) and [Security Enhancements in Android 6.0](https://source.android.com/docs/security/enhancements/enhancements60)
* More restrictive [SELinux](https://source.android.com/docs/security/features/selinux) (_IOCTL filtering_, tightening of _SELinux_ domains, etc.) see [Security-Enhanced Linux in Android](https://source.android.com/docs/security/features/selinux) and [Security Enhancements in Android 6.0](https://source.android.com/docs/security/enhancements/enhancements60)

## Android 7 (API 24) - Nougat

[Security Enhancements - Android 7](https://source.android.com/docs/security/enhancements#android-7)

* Separate _User_ and _System Certificate Trust Store_, meaning _Man-in-the-Middle_ attacks basically require root access from this point, see [Changes to Trusted Certificate Authorities in Android Nougat](https://android-developers.googleblog.com/2016/07/changes-to-trusted-certificate.html)
* Added [Network Security Config](https://developer.android.com/training/articles/security-config) support so apps can customize the behavior of their secure (_HTTPS_, _TLS_) connections in a simple declarative way, without code modification. It supports custom trust anchors (which [Certificate Authorities (CA)](https://en.wikipedia.org/wiki/Certificate_authority) the app trusts), debug-only overrides, _cleartext traffic_ opt-out and certificate pinning (limiting which server keys are trusted), see [Network Security Config section of Android 7.0 for Developers](https://developer.android.com/about/versions/nougat/android-7.0#network_security_config)
* By default apps targeting _Android 7.0_ only trust system-provided certificates and no longer trust user-added [Certificate Authorities (CA)](https://en.wikipedia.org/wiki/Certificate_authority), even without custom [Network Security Config](https://developer.android.com/training/articles/security-config), see [Default Trusted Certificate Authority of Android 7.0 for Developers](https://developer.android.com/about/versions/nougat/android-7.0#default_trusted_ca)
* Update to _Keymaster 2_ with support for [Key Attestation](https://source.android.com/docs/security/features/keystore/attestation#key-attestation) and version binding (preventing rolling back to an unsecure old version without losing keys), see [Key Attestation section of Android 7.0 for Developers](https://developer.android.com/about/versions/nougat/android-7.0#key_attestation) and [Keymaster Functions](https://source.android.com/docs/security/features/keystore/implementer-ref) and [Verifying hardware-backed key pairs with Key Attestation](https://developer.android.com/training/articles/security-key-attestation) and [Key and ID Attestation](https://source.android.com/docs/security/features/keystore/attestation)
* [File Based Encryption (FBE)](https://source.android.com/docs/security/features/encryption/file-based) introduced, but it's optional to implement by manufacturers, see [Direct Boot section of Android 7.0 for Developers](https://developer.android.com/about/versions/nougat/android-7.0#direct_boot) and [Support Direct Boot mode](https://developer.android.com/training/articles/direct-boot) and [Encryption](https://source.android.com/docs/security/features/encryption)
* Updated [SELinux](https://source.android.com/docs/security/features/selinux) configuration: further locking down application sandbox, breaking up mediaserver stack into smaller processes with reduced permissions (mitigation for Stagefright), see [Security-Enhanced Linux in Android](https://source.android.com/docs/security/features/selinux)

## Android 8 (API 26) - Oreo

[Security Enhancements - Android 8](https://source.android.com/docs/security/enhancements#android-8)

* _JavaScript_ evaluation runs in a separate process in `WebView` so _JavaScript_ code cannot access the app's memory so easily, see [What’s new in WebView security](https://android-developers.googleblog.com/2017/06/whats-new-in-webview-security.html) and [Security section of Android 8.0 Behavior Changes for All Apps](https://developer.android.com/about/versions/oreo/android-8.0-changes#security-all)
* `WebView` respects [Network Security Config](https://developer.android.com/training/articles/security-config) and `cleartextTrafficPermitted` flag (on older Android versions it loads _HTTP_ sites even if _clear text traffic_ should not be allowed by the config), see [Security section of Android 8.0 Behavior Changes for Apps Targeting Android 8.0](https://developer.android.com/about/versions/oreo/android-8.0-changes#o-sec)
* [Safe Browsing API](https://developer.android.com/develop/ui/views/layout/webapps/managing-webview#safe-browsing) added to `WebView` so users would be warned when trying to navigating to a potentially unsafe website (verified by [Google Safe Browsing](https://developers.google.com/safe-browsing/)) if enabled, see [WebView APIs section of Android 8.0 Features and APIs](https://developer.android.com/about/versions/oreo/android-8.0#wv)
* `FLAG_SECURE` `Window` flag is supported more and disallows taking screenshots of the screen where this is set
* Update to _Keymaster 3_ with rewritten [Hardware Abstraction Layers (HALs)](https://source.android.com/docs/core/architecture/hal) written in _HAL Interface Definition Language (HIDL)_ and in C++ (as compared to [Legacy HAL](https://source.android.com/docs/core/architecture/hal/archive) that was written in C) with [ID attestation](https://source.android.com/docs/security/features/keystore/attestation#id-attestation) support, see [Hardware-backed Keystore](https://source.android.com/docs/security/features/keystore) and [Keymaster Functions](https://source.android.com/docs/security/features/keystore/implementer-ref) and [Key and ID Attestation](https://source.android.com/docs/security/features/keystore/attestation)
* _Project Treble_ introduced (only devices released with this version support project Treble, the ones updated will not get it), separating lower-level vendor code from Android system framework and enabling easier security update delivery, see [Here comes Treble: A modular base for Android](https://android-developers.googleblog.com/2017/05/here-comes-treble-modular-base-for.html) and [Treble Plus One Equals Four](https://android-developers.googleblog.com/2020/12/treble-plus-one-equals-four.html)
* Updated [SELinux](https://source.android.com/docs/security/features/selinux) to work with _Treble_. _SELinux_ policy allows manufacturers and SOC vendors to update their parts of the policy independently from the platform and vice versa, see [Security-Enhanced Linux in Android](https://source.android.com/docs/security/features/selinux)
* Further hardening media stack: mobild [Hardware Abstraction Layers (HALs)](https://source.android.com/docs/core/architecture/hal) from running in a shared process to running in their own sandboxed processes
* To allow installing apps from unknown sources (i.e. not from _Google Play_) apps need explicit permission granted by the user for the particular app in Android settings (and users can revoke such permission and manage it per-app at any time too), see [User opt-in for unknown apps and sources section of Publish your app](https://developer.android.com/studio/publish#publishing-unknown) and [Security section of Android 8.0 Behavior Changes for All Apps](https://developer.android.com/about/versions/oreo/android-8.0-changes#security-all)

## Android 9 (API 28) - Pie

[Android 9 release notes - Security features](https://source.android.com/docs/setup/about/p-release-notes#security_features)

* _Cleartext network traffic (HTTP)_ disabled by default, apps need to explicitly set `cleartextTrafficPermitted` to `true` in their [Network Security Config](https://developer.android.com/training/articles/security-config) it if they still want to use it (not recommended), see [Network TLS enabled by default section of Behavior changes: apps targeting API level 28+](https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled) and [Android: Cleartext HTTP traffic not permitted Android 9](https://nphausg.medium.com/android-8-cleartext-http-traffic-not-permitted-73c1c9e3b803)
* Update to _Keymaster 4_ with support for _3DES_ encryption and secure key import, see [Hardware-backed Keystore](https://source.android.com/docs/security/features/keystore) and [Keymaster Functions](https://source.android.com/docs/security/features/keystore/implementer-ref)
* Replace many _BouncyCastle_ implementations of cryptographic algorithms with _Conscrypt_ ones, see [Conscrypt implementations of parameters and algorithms section of Android 9 Behavior changes: all apps](https://developer.android.com/about/versions/pie/android-9.0-changes-all#conscrypt_implementations_of_parameters_and_algorithms)
* Added support for embedded [Secure Element (SE)](https://source.android.com/docs/compatibility/cts/secure-element), see [Secure Element (SE) service section of Android 9 release notes](https://source.android.com/docs/setup/about/p-release-notes#secure_element_se_service) and [CTS test for Secure Element](https://source.android.com/docs/compatibility/cts/secure-element)
* _Disk Encryption_ (can be either [Full Disk Encryption (FDE)](https://source.android.com/docs/security/features/encryption/full-disk) or [File Based Encryption (FBE)](https://source.android.com/docs/security/features/encryption/file-based)) is mandatory for all devices (shipping with this version)
* [BiometricPrompt](https://developer.android.com/reference/android/hardware/biometrics/BiometricPrompt) introduced standardizing the UI that is shown during biometric authentication and providing a better API to apps that is harder to misuse, the previous solution, [FingerprintManager](https://developer.android.com/reference/android/hardware/fingerprint/FingerprintManager) gets _deprecated_, see [Show a biometric authentication dialog](https://developer.android.com/training/sign-in/biometric-auth)

## Android 10 (API 29) - Quince Tart

[Security Enhancements - Android 10](https://source.android.com/docs/security/enhancements#android-10)

[Android 10 release notes - Security features](https://source.android.com/docs/setup/about/android-10-release#security_features)

* File access disabled by default in `WebView`, see [setAllowFileAccess method of WebSettings](https://developer.android.com/reference/android/webkit/WebSettings#setAllowFileAccess(boolean))
* [TLS 1.3](https://en.wikipedia.org/wiki/Transport_Layer_Security#TLS_1.3) become available and enabled by default, see [TLS 1.3 enabled by default section of Android 10 Behavior changes: all apps](https://developer.android.com/about/versions/10/behavior-changes-all#tls-1.3)
* Certificates signed with _SHA-1_ no longer trusted in _TLS_
* Background apps cannot launch other _Activities_ (e.g. other apps), see [Background apps launching section of Android 10 release notes](https://source.android.com/docs/setup/about/android-10-release#background_apps_launching) and [Background activity restrictions section of Security and Privacy Enhancements in Android 10](https://source.android.com/docs/security/enhancements/enhancements10#background-activity)
* [File Based Encryption (FBE)](https://source.android.com/docs/security/features/encryption/file-based) is mandatory for devices that launch with this Android version (devices updated to it can still continue using [Full Disk Encryption (FDE)](https://source.android.com/docs/security/features/encryption/full-disk)), see [Encryption](https://source.android.com/docs/security/features/encryption)
* Only the default [Input Method Editor (IME)](https://developer.android.com/develop/ui/views/touch-and-input/creating-input-method) app can access _Clipboard_ data from the background, see [Limited access to clipboard data section of Privacy changes in Android 10](https://developer.android.com/about/versions/10/privacy/changes#clipboard-data) and [Clipboard data section of Security and Privacy Enhancements in Android 10](https://source.android.com/docs/security/enhancements/enhancements10#clipboard-data)
* [StrandHogg 2.0](https://promon.co/resources/downloads/strandhogg-2-0-new-serious-android-vulnerability/) exploit ([CVE-2020-0096](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0096)) no longer possible (a patch for the vulnerability is also backported to _Android 8.0_, _8.1_ and _9.0_ with the [May 2020 security update](https://source.android.com/docs/security/bulletin/2020-05-01) - if the manufacturer released the update to a device), see [StrandHogg Attack / Task Affinity Vulnerability](https://developer.android.com/topic/security/risks/strandhogg) and [StrandHogg 2.0 Exploit Explained - Why Users and Android App Developers should care](https://www.xda-developers.com/strandhogg-2-0-android-vulnerability-explained-developer-mitigation/) and [Strandhogg Vulnerability](https://androidexplained.github.io/security/android/malware/2020/09/23/strandhogg.html)
* [Project Mainline](https://source.android.com/docs/core/ota/modular-system) introduced (only devices released with this version support project Mainline, the ones updated to it cannot get it), building on top of Treble, which was introduced with Android 9 (API 26). This further simplifies and expedites Android updates. Mainline updates, more commonly known as _Google Play System Updates_ make possible to deliver selected AOSP components faster (the list of updatable components grows with newer Android versions), without needing a full OTA update from the phone manufacturer, see [Fresher OS with Projects Treble and Mainline](https://android-developers.googleblog.com/2019/05/fresher-os-with-projects-treble-and-mainline.html?m=1) and [What Are Google Play System Updates on Android, and Are They Important?](https://www.howtogeek.com/686927/what-are-google-play-system-updates-on-android-and-are-they-important/)

## Android 11 (API 30) - Red Velvet Cake

[Android 11 release notes - Secure](https://source.android.com/docs/setup/about/android-11-release#secure)

* _Task Hijacking_ ([StrandHogg 1.0](https://promon.co/security-news/the-strandhogg-vulnerability/)) exploit (when another app sets its `taskAffinity` to the same as the target to trick the user to launch it even if they inteded to launch the target app and used it's legitimate app icon) no longer possible, see [StrandHogg Attack / Task Affinity Vulnerability](https://developer.android.com/topic/security/risks/strandhogg) and [Strandhogg Vulnerability](https://androidexplained.github.io/security/android/malware/2020/09/23/strandhogg.html)
* Apps can no longer query information about other installed apps by default, see [Package visibility filtering on Android](https://developer.android.com/training/package-visibility) and [Package visibility in Android 11](https://medium.com/androiddevelopers/package-visibility-in-android-11-cc857f221cd9)
* _Runtime Permissions_ auto-reset for unused apps, see [Auto-reset permissions from unused apps section of Permissions updates in Android 11](https://developer.android.com/about/versions/11/privacy/permissions#auto-reset) and [Auto-reset permissions of unused apps section of Request runtime permissions](https://developer.android.com/training/permissions/requesting#auto-reset-permissions-unused-apps)
* [Scoped Storage](https://source.android.com/docs/core/storage/scoped) introduced, but apps can still opt-out of it via `requestLegacyExternalStorage`, see [Storage updates in Android 11](https://developer.android.com/about/versions/11/privacy/storage) and [Opt out in your production app section of Android storage use cases and best practices](https://developer.android.com/training/data-storage/use-cases#opt-out-in-production-app)
* Added standalone (not just as fallback) [DEVICE_CREDENTIAL](https://developer.android.com/reference/android/hardware/biometrics/BiometricManager.Authenticators#DEVICE_CREDENTIAL) (PIN, pattern or password) authenticator to [BiometricPrompt](https://developer.android.com/reference/android/hardware/biometrics/BiometricPrompt)
* [Toasts](https://developer.android.com/reference/android/widget/Toast) with custom views (set via `setView`) can no longer be launched from the background. This is to mitigate certain [Tapjacking](https://developer.android.com/privacy-and-security/risks/tapjacking) attacks that relied on those obscuring the UI of a victim app. Mind you, the whole `setView` method is deprecated in Android 11 (API 30). See [documentation of setView method of Toast](https://developer.android.com/reference/android/widget/Toast#setView(android.view.View))


## Android 12 (API 31) - Snow Cone

[Security Enhancements - Android 12](https://source.android.com/docs/security/enhancements#android-12)

[Android 12 release notes](https://source.android.com/docs/setup/about/android-12-release)

* `android:exported` flag needs to be defined _explicitly_ in Manifests for components (_Activities_, _Content Providers_, etc.) that declare [Intent Filters](https://developer.android.com/guide/topics/manifest/intent-filter-element), see [Safer component exporting section of Behavior changes: Apps targeting Android 12](https://developer.android.com/about/versions/12/behavior-changes-12#exported)
* Generic web _Intents_ resolve to user's default browser app _unless_ the target app is approved for the specific domain contained in that web _Intent_, see [Web intent resolution section of Android 12 Behavior changes: all apps](https://developer.android.com/about/versions/12/behavior-changes-all#web-intent-resolution)
* Replace more _BouncyCastle_ implementations of cryptographic algorithms with _Conscrypt_ ones, see [BouncyCastle implementation removed section of Android 12 Behavior changes: all apps](https://developer.android.com/about/versions/12/behavior-changes-all#bouncy-castle)
* The user gets notified if an app accesses _Clipboard_ data of another app for the first time, see [System notification shown when your app accesses clipboard data section of Copy and paste](https://developer.android.com/develop/ui/views/touch-and-input/copy-paste#PastingSystemNotifications)
* Apps can no longer close _System Dialogs_, see [Apps can't close system dialogs section of Android 12 Behavior changes: all apps](https://developer.android.com/about/versions/12/behavior-changes-all#close-system-dialogs)
* [Tapjacking](https://developer.android.com/topic/security/risks/tapjacking) mitigation: Apps are prevented from consuming touch events where an overlay obscures the app, see [Cloak & Dagger](https://cloak-and-dagger.org/)
* [Scoped Storage](https://source.android.com/docs/core/storage/scoped) always enforced, opting out of it via `requestLegacyExternalStorage` is no longer possible, see [Opt out in your production app section of Android storage use cases and best practices](https://developer.android.com/training/data-storage/use-cases#opt-out-in-production-app)
* New option to only grant permission to access approximate location
* New Privacy Indicators on the status bar to indicate to the user when an app uses camera or microphone
* [BiometricManager.Strings](https://developer.android.com/reference/android/hardware/biometrics/BiometricManager.Strings) API introduced providing localized strings for apps that use `BiometricPrompt` for authentication.
* Added support for _under-display_ fingerprint sensors
* [Fingerprint Android Interface Definition Language](https://android.googlesource.com/platform/hardware/interfaces/+/refs/heads/main/biometrics/fingerprint/2.3/IBiometricsFingerprint.hal) (AIDL) introduced
* `FLAG_SECURE` flag is added for biometric or device credential (_PIN_, _pattern_ or _password_) prompts, including both unlocking the device and [BiometricPrompt](https://developer.android.com/reference/android/hardware/biometrics/BiometricPrompt) in apps - this means you cannot take a screenshot of these screens and they also appear blacked out in screen shares, see [source for com.android.systemui.biometrics.AuthContainerView on Android Code Search](https://cs.android.com/android/platform/superproject/+/master:frameworks/base/packages/SystemUI/src/com/android/systemui/biometrics/AuthContainerView.java;l=843;bpv=0;bpt=0)
* [Private Compute Services](https://github.com/google/private-compute-services) introduced as a secure partition for processing sensitive user data on-device, used by AI-driven features like Live Caption, Now Playing and Smart Reply. Google defines it as a "secure, isolated data processing environment inside of the Android operating system that gives you control of the data inside, such as deciding if, how, and when it is shared with others". See [Introducing Android’s Private Compute Services](https://security.googleblog.com/2021/09/introducing-androids-private-compute.html), [Google officially explains how Android's Private Compute Core works](https://www.xda-developers.com/android-private-compute-core-explanation/) and [Android Private Compute Core Architecture whitepaper](https://arxiv.org/abs/2209.10317)
* Rust language support for platform development
* [Toasts](https://developer.android.com/reference/android/widget/Toast) are limited to two lines of text and show the application icon so users can identify which app shows them, see [Toast redesign section of Behavior Changes: apps targeting Android 12](https://developer.android.com/about/versions/12/behavior-changes-12#toast-redesign) and [Toasts overview](https://developer.android.com/guide/topics/ui/notifiers/toasts)

## Android 13 (API 33) - Tiramisu

[Security Enhancements - Android 13](https://source.android.com/docs/security/enhancements#android-13)

[Android 13 release notes - Security](https://source.android.com/docs/setup/about/android-13-release#security)

* Non-matching _Intents_ are blocked by _Intent filters_ (apps cannot send an _Intent_ to another app's exported component unless it fully matches the _Intent filter_ defined by it), see [Intents should match declared intent filters section of Android 13 and Android 13 QPR release notes](https://source.android.com/docs/setup/about/android-13-release#declared-intent-filters)
* Only [File Based Encryption (FBE)](https://source.android.com/docs/security/features/encryption/file-based) is allowed, [Full Disk Encryption (FDE)](https://source.android.com/docs/security/features/encryption/full-disk) is no longer - not even for devices updated from a version that it was allowed
* [Shared UIDs](https://developer.android.com/guide/topics/manifest/manifest-element#uid) are deprecated. It was used to share the sandbox access between two or more apps and the ability to run in the same process. It could cause non-deterministic behavior within the package manager so it would be removed in a future Android version. See [Application Signing](https://source.android.com/docs/security/features/apksigning)
* Keymaster support for symmetric cryptographic primitives such as _AES_ (Advanced Encryption Standard), _HMAC_ (Keyed-Hash Message Authentication Code), and asymmetric cryptographic algorithms (including _Elliptic Curve_, _RSA2048_, _RSA4096_, and _Curve 25519_)
* `POST_NOTIFICATIONS` runtime permission added for sending non-exempt (including _Foreground Services_ (FGS)) notifications from an app, see [Notification runtime permission](https://developer.android.com/develop/ui/views/notifications/notification-permission) and [android.permission.POST_NOTIFICATIONS](https://developer.android.com/reference/android/Manifest.permission#POST_NOTIFICATIONS)
* Apps need the runtime permission to show [Toasts](https://developer.android.com/guide/topics/ui/notifiers/toasts) when not in foreground. This can be _very_ counter-intuitive to describe to users why the app needs permission to post notifications if they only want to show you Toast messages, furthermore Toasts cannot be associated with [notification channels](https://developer.android.com/develop/ui/views/notifications/channels). See [source code of NotificationManagerService](https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/notification/NotificationManagerService.java#3765)
* Added _per-use_ prompt for apps requesting access to all device logs, giving users the ability to allow or deny access, see [Manage your device logs on Android](https://support.google.com/android/answer/12986432)
* [Android Virtualization Framework (AVF)](https://source.android.com/docs/core/virtualization) introduced, bringing together different hypervisors under one framework with standardized APIs.
* [APK signature scheme v3.1](https://source.android.com/docs/security/features/apksigning/v3-1) introduced, with all new key rotations that use `apksigner` will use the v3.1 signature scheme by default to target rotation for Android 13 and higher.
* [Restricted Settings](https://support.google.com/android/answer/12623953?hl=en) introduced to disallow sideloaded apps (installed without using the [session-based installation API](https://developer.android.com/reference/android/content/pm/PackageInstaller.Session)) from getting permissions deemed particularly dangerous by Google (users can still manually grant these permissions in Android Settings). Currently this applies to Accessibility and having a Notification Listener, see [Android 13's Restricted setting feature will block malicious apps from accessing your notifications](https://www.xda-developers.com/android-13-restricted-setting-notification-listener/). Keep in mind though that malicious apps aware of this restriction can bypass it by installing another app using said session-based installation API after they are installed, so restrictions not apply to the second app.

## Android 14 (API 34) - Upside Down Cake

[Security Enhancements - Android 14](https://source.android.com/docs/security/enhancements#android-14)

[Android 14 Security Release Notes](https://source.android.com/docs/security/bulletin/android-14)

* Introducing minimum `targetSdk` requirement: apps that target Android versions older than Android 6 (API 23) can no longer be installed. This means that you can assume that the [security restrictions](https://developer.android.com/about/versions/marshmallow/android-6.0-changes) (noteworthily [Runtime Permission handling](https://developer.android.com/training/permissions/requesting) in this case) introduced with Android 6 (API 23) now applies to all apps installed on the device (this minimum is expected to increase with each future Android versions), see [Minimum installable target API level section of Behavior changes: all apps](https://developer.android.com/about/versions/14/behavior-changes-all#minimum-target-api-level)
* The app's name, that stored a particular media file is redacted by default (unless it's package name is always visible to other apps or the app that queries it has the [`QUERY_ALL_PACKAGES`](https://developer.android.com/reference/android/Manifest.permission#QUERY_ALL_PACKAGES) permission granted - which requires special manual Google Play review to attain), see [Media owner package names might be redacted section of Behavior changes: all apps](https://developer.android.com/about/versions/14/behavior-changes-all#media-owner-package-names)
* Add some description to location permission prompts that describe why an app might need this permission.
* Significant improvements to [Hardware-assisted AddressSanitizer (HWASan)](https://source.android.com/docs/security/test/hwasan), which was introduced back in Android 10 as a memory error detection tool similar to the _deprecated_ [AddressSanitizer](https://source.android.com/docs/security/test/asan) which it replaces.
* Added support to reject null-ciphered cellular connections, ensuring that circuit-switched voice and SMS traffic is always encrypted and protected from passive over-the-air interception, see [Android 14 introduces first-of-its-kind cellular connectivity security features](https://security.googleblog.com/2023/08/android-14-introduces-first-of-its-kind.html)
* Added support for multiple IMEIs
* _AES-HCTR2_ is now the preferred mode of filenames encryption for devices with accelerated cryptography instructions.
* If an app targets Android 14 and uses [Dynamic Code Loading (DCL)](https://en.wikipedia.org/wiki/Dynamic_loading), all dynamically-loaded files must be marked as _read-only_ or otherwise, the system will throw an `Exception`, see [Safer dynamic code loading section of Behavior changes: Apps targeting Android 14 or higher](https://developer.android.com/about/versions/14/behavior-changes-14#safer-dynamic-code-loading)
* Added support for updating root certificates via [Project Mainline](https://source.android.com/docs/core/ota/modular-system) or more commonly known as _Google Play System Updates_, so a full OTA Android update is no longer required to introduce new CA certificates or remove revoked ones, see [Android 14 makes root certificates updatable via Google Play to protect users from malicious CAs](https://www.xda-developers.com/android-14-root-certificates-updatable)

## Android 15 (API 35) - Vanilla Ice Cream

[Android 15 Security Release Notes](https://source.android.com/docs/security/bulletin/android-15)

* Apps that target Android versions older than Android 7 (API 24) can no longer be installed. This means that you can assume that [security restrictions](https://developer.android.com/about/versions/nougat/android-7.0-changes) introduced with Android 7 (API 24) now applies to all apps installed on the device, see [Increased minimum target SDK version from 23 to 24 section of Behavior changes: all apps](https://developer.android.com/about/versions/15/behavior-changes-all#minimum-target-api-level)
* The system now asks for biometrics (if they are enrolled) when changing USB mode and screen timeout, see [Android 15 will verify it's you when you connect to a PC](https://www.androidauthority.com/android-15-authentication-switch-usb-modes-3427734/)
* Further mitigation for task hijacking (StrandHogg): if the top activity finishes a task, Android will go back to whichever task was last active. Moreover, if a non-top activity finishes its task, Android will go back to the home screen; it won't block the finish of this non-top activity, see [Other changes section of Behavior changes: Apps targeting Android 15 or higher](https://developer.android.com/about/versions/15/behavior-changes-15#other_changes)
* Further mitigation for task hijacking (StrandHogg): Arbitrary activities can no longer be launched from other apps into your own task, see [Other changes section of Behavior changes: Apps targeting Android 15 or higher](https://developer.android.com/about/versions/15/behavior-changes-15#other_changes)
* Mitigation for attackers abusing misconfigured PendingIntents: `PendingIntent` creators now block [background Activity launches](https://developer.android.com/guide/components/activities/background-starts) by default if your app targets Android 15 (API 35), see [Other changes section of Behavior changes: Apps targeting Android 15 or higher](https://developer.android.com/about/versions/15/behavior-changes-15#other_changes)
* By default, apps are no longer allowed to bring the task stack to the foreground unless the `PendingIntent` creator allows background activity launch privileges or the sender has background activity launch privileges, if your app targets Android 15 (API 35), see [Other changes section of Behavior changes: Apps targeting Android 15 or higher](https://developer.android.com/about/versions/15/behavior-changes-15#other_changes)
* Non-visible windows are now blocked from being considered for background activity launches. This mitigates _Denial of Service (DoS)_ attacks and popup ads, while also provides mitigation for full or partial [tapjacking](https://developer.android.com/privacy-and-security/risks/tapjacking) and full-screen phishing, see [Other changes section of Behavior changes: Apps targeting Android 15 or higher](https://developer.android.com/about/versions/15/behavior-changes-15#other_changes)
* New detection capabilities for [StrictMode](https://developer.android.com/reference/android/os/StrictMode) (this will be enforced in Android 16 by default): Intents that target specific components must accurately match the target's intent-filter specifications. If you send an intent to launch another app's activity, the target intent component needs to align with the receiving activity's declared intent-filters, and Intents without an action (action set to `null`) will no longer match any intent-filters. This means that intents used to start activities or services must have a clearly defined action, see [Safer Intents section of Behavior changes: Apps targeting Android 15 or higher](https://developer.android.com/about/versions/15/behavior-changes-15#safer-intents)
* The creator of the `PendingIntent` is treated as the _sender of the enclosing intent_, not the _sender of the pending intent_, see [Safer Intents section of Behavior changes: Apps targeting Android 15 or higher](https://developer.android.com/about/versions/15/behavior-changes-15#safer-intents)
* [Google Play Protect](https://developers.google.com/android/play-protect/) requires biometric or device credential (PIN, password or pattern that's used to unlock the device) confirmation before sideloading apps that target Android 10 (API 29) or earlier. This is part of an ongoing effort to fight malicious apps by Play Protect with more similar prompts likely coming (possibly without even requiring a new OS version), see [Google to add extra layer of protection when installing sketchy apps (APK teardown)](https://www.androidauthority.com/play-store-apk-biometric-scan-3451489/)
* Failing to provide the right credentials to a [BiometricPrompt](https://developer.android.com/reference/android/hardware/biometrics/BiometricPrompt) many (5) times from now on locks the device itself. If a biometric credential (e.g., fingerprint) was not recognized this many times, the device can only be unlocked with a secure _device credential_ (PIN, pattern or password). Furthermore, if that was already used unsuccessfully, a 60 seconds timeout need to pass before the device can be unlocked at all. This also brings a change in behavior for the `BiometricPrompt`: it cannot "fall back" to device credentials after failing with biometrics to still complete the user authentication. Note that the user can still use device credentials _by choice_ via a button on the prompt if that authenticator is allowed (and if they did not fail the prompt too many times already). When the device gets locked, the prompt will be cancelled and a new prompt needs to be triggered after the device is unlocked to succeed with the authentication. See [Android 15 makes sure thieves can't clean out your bank account if they steal your unlocked phone](https://www.androidpolice.com/android-15-failed-authentication-lock-sensitive-data/)
